{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "4ab50fe7-ed8a-449e-94ea-bef682c62278",
   "metadata": {},
   "outputs": [],
   "source": [
    "---SQL Query to identify the database column affected and the respective table.\n",
    "SELECT TABLE_NAME\n",
    "FROM INFORMATION_SCHEMA.COLUMNS\n",
    "WHERE COLUMN_NAME = 'Column Name'\n",
    "order by COLUMN_NAME ASC\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Categories in the Clyzo Portal.\n",
    "select distinct Labelling Claims from SupplierProductMaster where TRUE_Status = 1 \n",
    "select distinct Dosage_Form from SupplierProductMaster where TRUE_Status = 1 \n",
    "select distinct ChemicalFamily from ClyzoProductMaster where Status = 1\n",
    "select distinct Functions from ClyzoProductMaster where Status = 1\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Determine the Number of Tables  in the Database.\n",
    "SELECT \n",
    "    'Tables' AS Object Type,\n",
    "    COUNT(*) AS Object Count\n",
    "FROM \n",
    "    sys.objects\n",
    "WHERE \n",
    "    type = 'U'  \n",
    "\n",
    "UNION ALL\n",
    "\n",
    "\n",
    "\n",
    "------SQL Query to Determine the Number of views  in the Database.\n",
    "SELECT \n",
    "    'Views' AS Object Type,\n",
    "    COUNT(*) AS Object Count\n",
    "FROM \n",
    "    sys.objects\n",
    "WHERE \n",
    "    type = 'V'; \n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve All Tables with Their Names.\n",
    "SELECT \n",
    "        name AS Object Name,\n",
    "        'Table' AS Object Type\n",
    "    FROM \n",
    "        sys.objects\n",
    "    WHERE \n",
    "        type = 'U'  \n",
    "\n",
    "\n",
    "---SQL Query to Retrieve All Views with Their Names.      \n",
    "SELECT \n",
    "        name AS Object Name,\n",
    "        'View' AS Object Type\n",
    "    FROM \n",
    "        sys.objects\n",
    "    WHERE \n",
    "        type = 'V' \n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Find Multiple Columns in the Database Across Different Tables.\n",
    "SELECT TABLE_NAME\n",
    "FROM INFORMATION_SCHEMA.COLUMNS\n",
    "WHERE COLUMN_NAME IN ('','')\n",
    "ORDER BY COLUMN_NAME DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Perform a Database Backup.\n",
    "SELECT \n",
    "    bs.database_name,\n",
    "    bs.backup_start_date,\n",
    "    bs.backup_finish_date,\n",
    "    bs.backup_size / 1024 / 1024 AS backup_size_mb,\n",
    "    bs.type AS backup type,\n",
    "    CASE \n",
    "        WHEN bs.type = 'D' THEN 'Full'\n",
    "        WHEN bs.type = 'I' THEN 'Differential'\n",
    "        WHEN bs.type = 'L' THEN 'Log'\n",
    "        ELSE 'Other'\n",
    "    END AS backup_type_desc,\n",
    "    bmf.physical_device_name AS backup_file_location\n",
    "FROM \n",
    "    msdb.dbo.backupset bs\n",
    "INNER JOIN \n",
    "    msdb.dbo.backupmediafamily bmf \n",
    "    ON bs.media_set_id = bmf.media_set_id\n",
    "WHERE \n",
    "    bs.database_name = 'CLYZO'\n",
    "ORDER BY \n",
    "    bs.backup_finish_date DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query for Time-Based Consolidation of Multiple Tables.\n",
    "SELECT\n",
    "    CAST(Added Date AS DATE) AS Date Only,\n",
    "    Company Name AS Company Name,\n",
    "    QutationNO AS RecordID \n",
    "FROM\n",
    "    bivwQuotation_Report\n",
    "UNION ALL\n",
    "SELECT\n",
    "    CAST(DateofRequest AS DATE) AS Date Only,\n",
    "    Company Name AS Company Name,\n",
    "    ClyzoRequestno AS RecordID  -- Use unique identifier if available\n",
    "FROM\n",
    "    bivwRequest_Report\n",
    "UNION ALL\n",
    "SELECT\n",
    "    CAST(DownloadDateTime AS DATE) AS Date Only,\n",
    "    Company Name AS Company Name,\n",
    "    Company Name AS RecordID  -- Use unique identifier if available\n",
    "FROM\n",
    "    vwCOAMSDSTDSDocsDownload;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve User Sign-Up Information.\n",
    "select tbl_ClyzoEmployeeMaster.ID,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName, tbl_ClyzoEmployeeMaster.Email,tbl_ClyzoEmployeeMaster.Added_Date,tbl_ClyzoEmployeeMaster.Company_Name, tbl_ClyzoEmployeeLoginMaster.Status from tbl_ClyzoEmployeeMaster\n",
    "join tbl_ClyzoEmployeeLoginMaster\n",
    "on tbl_ClyzoEmployeeMaster.ID = tbl_ClyzoEmployeeLoginMaster.Employee_ID\n",
    "where tbl_ClyzoEmployeeMaster.Added_Date between '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and\n",
    "Company_Name not in ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT')\n",
    "order by tbl_ClyzoEmployeeMaster.Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Count User Login and Logout Activities.\n",
    "SELECT \n",
    "    Login_Logout_Log.UserId,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_FirstName,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_LastName,\n",
    "    tbl_ClyzoEmployeeMaster.Company_Name,\n",
    "    Login_Logout_Log.LoginDate,\n",
    "    Login_Logout_Log.LogoutDate,\n",
    "    DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) AS LoginDurationInMinute,\n",
    "    CONCAT(\n",
    "        FLOOR(DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) / 60), ' hours ',\n",
    "        DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) % 60, ' minutes'\n",
    "    ) AS LoginDurationFormatted\n",
    "FROM \n",
    "    Login_Logout_Log\n",
    "JOIN \n",
    "    tbl_ClyzoEmployeeMaster ON Login_Logout_Log.UserId = tbl_ClyzoEmployeeMaster.ID\n",
    "WHERE \n",
    "    Login_Logout_Log.LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND tbl_ClyzoEmployeeMaster.Company_Name NOT IN ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions') \n",
    "ORDER BY LoginDurationFormatted DESC\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Product Document Download Information.\n",
    "select * from vwCOAMSDSTDSDocsDownload WHERE DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and \n",
    "Company_Name not in ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions','CLYZO','Clyzo','clyzo','Planet Science','Pharmonix Biologicals Private Limited') and User_ID =4827 \n",
    "order by Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Document Names Along with Their Download Counts.\n",
    "SELECT \n",
    "    Document_Name,\n",
    "    COUNT(*) AS DownloadCount\n",
    "FROM \n",
    "    vwCOAMSDSTDSDocsDownload\n",
    "WHERE \n",
    "    DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND Company_Name NOT IN ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions','CLYZO', 'Clyzo', 'clyzo', 'Planet Science', 'Pharmonix Biologicals Private Limited')\n",
    "GROUP BY \n",
    "    Document_Name\n",
    "ORDER BY \n",
    "    DownloadCount DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Document Download Counts by User.\n",
    "SELECT \n",
    "    USRNAME, \n",
    "\tDocument_Name,\n",
    "\tCompany_Name,\n",
    "    COUNT(*) AS DownloadCount\n",
    "FROM \n",
    "    vwCOAMSDSTDSDocsDownload\n",
    "WHERE \n",
    "    DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND Company_Name NOT IN ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions','CLYZO', 'Clyzo', 'clyzo', 'Planet Science', 'Pharmonix Biologicals Private Limited')\n",
    "GROUP BY \n",
    "    USRNAME,\n",
    "\tDocument_Name,\n",
    "\tCompany_Name\n",
    "ORDER BY \n",
    "    DownloadCount Desc;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Downloaded the Most Documents.\n",
    "SELECT \n",
    "    USRNAME,\n",
    "\tCompany_Name,\n",
    "    COUNT(*) AS Download Count\n",
    "FROM \n",
    "    vwCOAMSDSTDSDocsDownload\n",
    "WHERE \n",
    "    DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND Company_Name NOT IN ('CLYZO', 'Clyzo', 'clyzo', 'Planet Science', 'Pharmonix Biologicals Private Limited','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "GROUP BY \n",
    "    USRNAME,\n",
    "\tCompany_Name\n",
    "ORDER BY \n",
    "    DownloadCount DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve User Search History.\n",
    "select tbl_ClyzoEmployeeMaster.ID,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,Tbl_SearchHistory.Search,Tbl_SearchHistory.SearchType,Tbl_SearchHistory.SearchDate,tbl_ClyzoEmployeeMaster.Company_Name,tbl_ClyzoEmployeeMaster.Email from Tbl_SearchHistory\n",
    "Join tbl_ClyzoEmployeeMaster\n",
    "on Tbl_SearchHistory.SearchBy = tbl_ClyzoEmployeeMaster.ID\n",
    "where Tbl_SearchHistory.SearchDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('CLYZO','Clyzo','clyzo','Planet Science','Pharmonix Biologicals Private Limited','Plane Science','Swaransoft Support Solutions','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions') \n",
    "order by Company_Name\n",
    "\n",
    "\n",
    "---SQL Query to Calculate Actual User Login Duration and Time Spent.\n",
    "SELECT \n",
    "    Login_Logout_Log.UserId,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_FirstName,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_LastName,\n",
    "    tbl_ClyzoEmployeeMaster.Company_Name,\n",
    "    Login_Logout_Log.LoginDate,\n",
    "    Login_Logout_Log.LogoutDate,\n",
    "    DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) AS LoginDurationInMinute,\n",
    "    CONCAT(\n",
    "        FLOOR(DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) / 60), ' hours ',\n",
    "        DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) % 60, ' minutes'\n",
    "    ) AS LoginDurationFormatted\n",
    "FROM \n",
    "    Login_Logout_Log\n",
    "JOIN \n",
    "    tbl_ClyzoEmployeeMaster ON Login_Logout_Log.UserId = tbl_ClyzoEmployeeMaster.ID\n",
    "WHERE \n",
    "    Login_Logout_Log.LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND tbl_ClyzoEmployeeMaster.Company_Name NOT IN ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "    AND DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) IS NOT NULL\n",
    "ORDER BY \n",
    "    LoginDurationFormatted DESC\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify the Top 5 Users Who Spend the Most Time Logged In.\n",
    "SELECT \n",
    "    Login_Logout_Log.UserId,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_FirstName,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_LastName,\n",
    "    tbl_ClyzoEmployeeMaster.Company_Name,\n",
    "\ttbl_ClyzoEmployeeMaster.Email,\n",
    "    Login_Logout_Log.LoginDate,\n",
    "    Login_Logout_Log.LogoutDate,\n",
    "    DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) AS LoginDurationInMinute,\n",
    "    CONCAT(\n",
    "        FLOOR(DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) / 60), ' hours ',\n",
    "        DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) % 60, ' minutes'\n",
    "    ) AS LoginDurationFormatted\n",
    "FROM \n",
    "    Login_Logout_Log\n",
    "JOIN \n",
    "    tbl_ClyzoEmployeeMaster ON Login_Logout_Log.UserId = tbl_ClyzoEmployeeMaster.ID\n",
    "WHERE \n",
    "    Login_Logout_Log.LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND tbl_ClyzoEmployeeMaster.Company_Name NOT IN ('Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "    AND DATEDIFF(MINUTE, Login_Logout_Log.LoginDate, Login_Logout_Log.LogoutDate) IS NOT NULL\n",
    "ORDER BY \n",
    "    LoginDurationFormatted Desc\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Generate Product Page Visit Report.\n",
    "select UserActivityPage.ProductName, UserActivityPage.SupplierCode,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,UserActivityPage.KAE_Name,UserActivityPage.CompanyName,UserActivityPage.UserEmail,FORMAT(UserActivityPage.TimeAccessed, 'yyyy-MM-dd HH:mm') AS TimeAccessed from UserActivityPage \n",
    "left outer join tbl_ClyzoEmployeeMaster on tbl_ClyzoEmployeeMaster.Email=UserActivityPage.UserEmail \n",
    "where PageAccessed like '%excipient/%/%' and TimeAccessed BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('CLYZO','','Pharmonix Biologicals Private Limited','CLYZO','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "order by Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve User Requests.\n",
    "Select * from bivwRequest_Report where DateofRequest BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and \n",
    "CompanyName not in ('Swaransoft Support Solutions','Pharmonix Biologicals Private Limited','CLYZO','Planet Science','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "order by CompanyName\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Users Who Signed Up and Downloaded Documents.\n",
    "SELECT \n",
    "    e.ID, \n",
    "    e.Employee_FirstName, \n",
    "    e.Employee_LastName, \n",
    "    e.Email, \n",
    "    e.Added_Date, \n",
    "    e.Company_Name, \n",
    "    l.Status, \n",
    "    d.DownloadDateTime, \n",
    "    d.Supplier_Product_Name,\n",
    "\td.Product_Code\n",
    "FROM \n",
    "    tbl_ClyzoEmployeeMaster AS e\n",
    "JOIN \n",
    "    tbl_ClyzoEmployeeLoginMaster AS l\n",
    "    ON e.ID = l.Employee_ID\n",
    "JOIN \n",
    "    vwCOAMSDSTDSDocsDownload AS d\n",
    "    ON e.Email = d.Email  \n",
    "WHERE \n",
    "    e.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND d.DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND e.Company_Name NOT IN ('Vikram Testing', 'CLYZO', 'CLYZO_Testing')\n",
    "    AND d.Company_Name NOT IN ('CLYZO', 'Clyzo', 'clyzo', 'Planet Science', 'Pharmonix Biologicals Private Limited','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "ORDER BY \n",
    "    e.Added_Date;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Unique Users Who Signed Up and Downloaded Documents.\n",
    "SELECT DISTINCT\n",
    "    e.ID, \n",
    "    e.Employee_FirstName, \n",
    "    e.Employee_LastName, \n",
    "    e.Email, \n",
    "    e.Company_Name \n",
    "FROM \n",
    "    tbl_ClyzoEmployeeMaster AS e\n",
    "JOIN \n",
    "    tbl_ClyzoEmployeeLoginMaster AS l\n",
    "    ON e.ID = l.Employee_ID\n",
    "JOIN \n",
    "    vwCOAMSDSTDSDocsDownload AS d\n",
    "    ON e.Email = d.Email  \n",
    "WHERE \n",
    "    e.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND d.DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "    AND e.Company_Name NOT IN ('Vikram Testing', 'CLYZO', 'CLYZO_Testing')\n",
    "    AND d.Company_Name NOT IN ('CLYZO', 'Clyzo', 'clyzo', 'Planet Science', 'Pharmonix Biologicals Private Limited','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "ORDER BY \n",
    "   e.ID ;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Searched for Products and Also Downloaded Documents\n",
    "select Distinct tbl_ClyzoEmployeeMaster.ID,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,tbl_ClyzoEmployeeMaster.Email,tbl_ClyzoEmployeeMaster.Company_Name from Tbl_SearchHistory\n",
    "Join tbl_ClyzoEmployeeMaster\n",
    "on Tbl_SearchHistory.SearchBy = tbl_ClyzoEmployeeMaster.ID\n",
    "where Tbl_SearchHistory.SearchDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('CLYZO','Clyzo','clyzo','Planet Science','Pharmonix Biologicals Private Limited','Plane Science','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions') \n",
    "AND tbl_ClyzoEmployeeMaster.ID IN (\n",
    "SELECT DISTINCT User_ID\n",
    "        FROM \n",
    "            vwCOAMSDSTDSDocsDownload \n",
    "        JOIN \n",
    "            tbl_ClyzoEmployeeMaster\n",
    "            ON vwCOAMSDSTDSDocsDownload.Email = tbl_ClyzoEmployeeMaster.Email\n",
    "        WHERE \n",
    "            vwCOAMSDSTDSDocsDownload.DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "            AND vwCOAMSDSTDSDocsDownload.Company_Name NOT IN ('CLYZO','Clyzo','clyzo','Planet Science','Pharmonix Biologicals Private Limited')\n",
    "    )\n",
    "ORDER BY \n",
    "    tbl_ClyzoEmployeeMaster.ID;\n",
    "\n",
    "\n",
    "    \n",
    "---SQL Query to Retrieve Company Creation Requests and Their Associated Created Quotations.\n",
    "SELECT bivwRequest_Report.ID,\n",
    "       bivwRequest_Report.ClyzoRequestno,\n",
    "\t   bivwRequest_Report.RequestType,\n",
    "\t   bivwRequest_Report.DateofRequest,\n",
    "\t   bivwRequest_Report.ProductCode AS Product_Code,\n",
    "\t   bivwRequest_Report.ProductName,\n",
    "\t   bivwRequest_Report.CompanyName,\n",
    "\t   bivwRequest_Report.user_name,\n",
    "\t   bivwRequest_Report.KAE,\n",
    "\t   bivwRequest_Report.status\n",
    "FROM bivwRequest_Report \n",
    "WHERE DateofRequest BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' \n",
    "  AND CompanyName NOT IN ('Clyzo', 'CLYZO', 'Planet Science')\n",
    "  AND bivwRequest_Report.ProductCode IN (\n",
    "      SELECT Product_Code \n",
    "      FROM bivwQuotation_Report \n",
    "      WHERE Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' \n",
    "        AND Company_Name NOT IN ('Swaransoft Support Solutions', 'Pharmonix Biologicals Private Limited', 'CLYZO','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "  )\n",
    "\n",
    "---SQL Query to Identify Users Who Sent Requests and Downloaded Documents.\n",
    "SELECT bivwRequest_Report.ID,\n",
    "       bivwRequest_Report.ClyzoRequestno,\n",
    "       bivwRequest_Report.RequestType,\n",
    "       bivwRequest_Report.DateofRequest,\n",
    "       bivwRequest_Report.ProductCode AS Product_Code,\n",
    "       bivwRequest_Report.ProductName,\n",
    "       bivwRequest_Report.CompanyName,\n",
    "       bivwRequest_Report.user_name,\n",
    "       bivwRequest_Report.KAE,\n",
    "       bivwRequest_Report.status\n",
    "FROM bivwRequest_Report \n",
    "WHERE DateofRequest BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' \n",
    "  AND CompanyName NOT IN ('Clyzo', 'CLYZO', 'Planet Science','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "  AND bivwRequest_Report.ProductCode IN (\n",
    "      SELECT Product_Code \n",
    "      FROM vwCOAMSDSTDSDocsDownload \n",
    "      WHERE DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' \n",
    "        AND Company_Name NOT IN ('CLYZO', 'Clyzo', 'clyzo', 'Planet Science', 'Pharmonix Biologicals Private Limited','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "  )\n",
    "ORDER BY bivwRequest_Report.CompanyName;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve the Number of Quotations Created by Each User.\n",
    "SELECT CONCAT(Employee_FirstName, ' ', Employee_LastName) AS Employee_FullName, \n",
    "       Company_Name,\n",
    "       Email,\n",
    "       COUNT(*) AS total_quotations\n",
    "FROM bivwQuotation_Report\n",
    "WHERE Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'  \n",
    "  AND Company_Name NOT IN ('Pharmonix Biologicals Private Limited', 'Swaransoft Support Solutions', \n",
    "                           'Pharmonix', 'CLYZO', 'NULL', 'Planet Science', \n",
    "                           'Clyzo', 'Impulse Digital', 'Planet Science Private Limited','Plane Science','Inventia Healthcare Limited','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "GROUP BY CONCAT(Employee_FirstName, ' ', Employee_LastName), Company_Name, Email\n",
    "ORDER BY total_quotations DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify the Most Quoted Product from Each Company.\n",
    "SELECT Company_Name, \n",
    "       Product_Code, \n",
    "       Product_Name, \n",
    "       COUNT(*) AS Quotations_Created\n",
    "FROM bivwQuotation_Report\n",
    "WHERE Company_Name = 'Caplin Steriles/Caplin Point Laboratories Limited'\n",
    "GROUP BY Company_Name, Product_Code, Product_Name\n",
    "ORDER BY Quotations_Created DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Analyze Trends in Quotation Amounts.\n",
    "SELECT Company_Name,\n",
    "       QuotationStatus,\n",
    "       FORMAT(Added_Date, 'MMMM yyyy') AS Month_Year,\n",
    "       FORMAT(SUM(Final_Amount), 'N2') AS Total_Quotation_Amount,\n",
    "       COUNT(*) AS Total_Quotations\n",
    "FROM bivwQuotation_Report\n",
    "WHERE Company_Name = 'Caplin Steriles/Caplin Point Laboratories Limited' and QuotationStatus ='Converted to Order'\n",
    "GROUP BY Company_Name, QuotationStatus,FORMAT(Added_Date, 'MMMM yyyy')\n",
    "ORDER BY MIN(Added_Date);\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Track the Time Intervals Between Quotations.\n",
    "WITH Quotation_Timing AS (\n",
    "  SELECT Company_Name, \n",
    "         Added_Date, \n",
    "         LAG(Added_Date) OVER (PARTITION BY Company_Name ORDER BY Added_Date) AS previous_quotation\n",
    "  FROM bivwQuotation_Report\n",
    "  WHERE Company_Name = 'Caplin Steriles/Caplin Point Laboratories Limited'\n",
    ")\n",
    "SELECT Company_Name, \n",
    "       Added_Date, \n",
    "       DATEDIFF(day, previous_quotation, Added_Date) AS days_between_quotations\n",
    "FROM Quotation_Timing\n",
    "WHERE previous_quotation IS NOT NULL\n",
    "ORDER BY Added_Date;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Calculate the Quotation Success Rate for Each Company.\n",
    "SELECT Company_Name, \n",
    "       COUNT(CASE WHEN QuotationStatus = 'Converted to Order' THEN 1 END) AS Successful_Order, \n",
    "       COUNT(*) AS total_quotations, \n",
    "       (COUNT(CASE WHEN QuotationStatus = 'Converted to Order' THEN 1 END) * 100.0 / COUNT(*)) AS success_rate\n",
    "FROM bivwQuotation_Report\n",
    "WHERE Company_Name = 'Caplin Steriles/Caplin Point Laboratories Limited' \n",
    "GROUP BY Company_Name;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify the Top 5 Quoted Products.\n",
    "SELECT\n",
    "    Product_Code,\n",
    "    Product_Name,\n",
    "    COUNT(QutationNo) AS quotation_count\n",
    "FROM\n",
    "    bivwQuotation_Report\n",
    "where Company_Name not in ('Swaransoft Support Solutions','Planet Science Private Limited','Planet Science','Plane Science','Pharmonix Biologicals Private Limited','Pharmonix','Inventia Healthcare Limited','Impulse Digital','Etico Lifesciences Pvt. Ltd.','encube ethicals pvrt ltd','Clyzo','CLYZO','NULL','Swaransoft Support Solutions','Pharmonix Biologicals Private Limited','CLYZO','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "GROUP BY\n",
    "    Product_Code,\n",
    "    Product_Name\n",
    "ORDER BY\n",
    "    quotation_count DESC\n",
    "OFFSET 0 ROWS\n",
    "FETCH NEXT 5 ROWS ONLY;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Trace User Activity.\n",
    "select tbl_ClyzoEmployeeMaster.ID,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName, tbl_ClyzoEmployeeMaster.Email,tbl_ClyzoEmployeeMaster.Added_Date,tbl_ClyzoEmployeeMaster.Company_Name, tbl_ClyzoEmployeeLoginMaster.Status from tbl_ClyzoEmployeeMaster\n",
    "join tbl_ClyzoEmployeeLoginMaster\n",
    "on tbl_ClyzoEmployeeMaster.ID = tbl_ClyzoEmployeeLoginMaster.Employee_ID\n",
    "where tbl_ClyzoEmployeeMaster.Added_Date between '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('Vikram Testing','CLYZO','CLYZO_Testing','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions')\n",
    "order by tbl_ClyzoEmployeeMaster.Added_Date\n",
    "\n",
    "\n",
    "--General Queries.\n",
    "select Distinct UserId from Login_Logout_Log where LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and \n",
    "UserId =4827\n",
    "\n",
    "\n",
    "select Distinct SearchBy from Tbl_SearchHistory where SearchDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'  order by SearchBy and SearchBy= 4827\n",
    "\n",
    "\n",
    "\n",
    "select UserActivityPage.ProductName, UserActivityPage.SupplierCode,tbl_ClyzoEmployeeMaster.ID,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,UserActivityPage.KAE_Name,UserActivityPage.CompanyName,UserActivityPage.UserEmail,FORMAT(UserActivityPage.TimeAccessed, 'yyyy-MM-dd HH:mm') AS TimeAccessed from UserActivityPage \n",
    "left outer join tbl_ClyzoEmployeeMaster on tbl_ClyzoEmployeeMaster.Email=UserActivityPage.UserEmail \n",
    "where PageAccessed like '%excipient/%/%' and TimeAccessed BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and UserActivityPage.CompanyName not in ('CLYZO','Pharmonix Biologicals Private Limited','NULL','','Pharmonix Biologicals Private Limited_Domain','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions') and \n",
    "tbl_ClyzoEmployeeMaster.ID =4822\n",
    "\n",
    "\n",
    "\n",
    "select * from vwCOAMSDSTDSDocsDownload WHERE DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('CLYZO','Clyzo','clyzo','Planet Science','Pharmonix Biologicals Private Limited','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions') and \n",
    "User_ID = 4827\n",
    "\n",
    "\n",
    "\n",
    "select tbl_ClyzoEmployeeMaster.ID,* from bivwQuotation_Report \n",
    "join tbl_ClyzoEmployeeMaster \n",
    "on tbl_ClyzoEmployeeMaster.Email = bivwQuotation_Report.Email\n",
    "where bivwQuotation_Report.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and bivwQuotation_Report.Company_Name not in ('Pharmonix Biologicals Private Limited','CLYZO','Vikram Testing','CLYZO','CLYZO_Testing','test','Pharmonix Biologicals Pvt. Ltd.','Clyzo','clyzo','Planet Science','Pharmonix','Pharmonix Pvt Ltd','Plane Science','Swaransoft Support Solutions','NULL','Pharmonix Biological','ABC','Test','Pharmonix Biologicals Private Limited','Orange Pharma','The Impulse Digital','Impulse Digital','Planet Science Private Limited','IT infotech pvt ltd','JT PHARMA PVT LTD','xyz','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef ','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','It Tech','encube ethicals pvrt ltd','Encube Ethicals Pvt. Ltd.','Fresher','Inventia Healthcare Limited','NA','SPIT','Vikram Testing', 'CLYZO', 'CLYZO_Testing', 'Planet Science', 'Plane Science', 'Pharmonix Biologicals Private Limited','Swaransoft Support Solutions') and \n",
    "tbl_ClyzoEmployeeMaster.ID = 4822\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Signed Up but Have Not Logged In.\n",
    "select tbl_clyzoemployeemaster.ID,tbl_clyzoemployeemaster.Employee_FirstName,tbl_clyzoemployeemaster.Employee_LastName,tbl_clyzoemployeemaster.Company_Name,DomainMaster_KAE.KAE_Account\n",
    "from tbl_clyzoemployeemaster\n",
    "left Join Login_Logout_Log on tbl_clyzoemployeemaster.ID = Login_Logout_Log.UserId\n",
    "Join DomainEmployeeMap on tbl_clyzoemployeemaster.ID = DomainEmployeeMap.ClyzoEmployeeMaster\n",
    "Join DomainMaster on DomainEmployeeMap.DomainID = DomainMaster.Id\n",
    "Join DomainMaster_KAE on DomainMaster.KAEID = DomainMaster_KAE.KAE_ID\t\n",
    "where Login_Logout_Log.UserId IS NULL and tbl_clyzoemployeemaster.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('NULL','test') and DomainMaster_KAE.KAE_Account not in ('Rosy Sawant')\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Domain Sign-Up Activity\n",
    "select * from DomainMaster where Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Have Logged In but Do Not Appear in Search History.\n",
    "select Distinct Login_Logout_Log.Userid,tbl_clyzoemployeemaster.Employee_FirstName,tbl_clyzoemployeemaster.Employee_LastName,tbl_clyzoemployeemaster.Company_Name,DomainMaster_KAE.KAE_Account from Login_Logout_Log\n",
    "left Join Tbl_SearchHistory on Login_Logout_Log.Userid = Tbl_SearchHistory.SearchBy\n",
    "Join tbl_clyzoemployeemaster on tbl_clyzoemployeemaster.ID = Login_Logout_Log.Userid\n",
    "Join DomainEmployeeMap on tbl_clyzoemployeemaster.ID = DomainEmployeeMap.ClyzoEmployeeMaster\n",
    "Join DomainMaster on DomainEmployeeMap.DomainID = DomainMaster.Id\n",
    "Join DomainMaster_KAE on DomainMaster.KAEID = DomainMaster_KAE.KAE_ID\n",
    "where Tbl_SearchHistory.SearchBy IS NULL and Login_Logout_Log.LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and Company_Name not in ('CLYZO_Testing','Vikram Testing','Test','xyz','Swaransoft Support Solutions','CLYZO')\n",
    "order by tbl_clyzoemployeemaster.Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Have Logged In but Have Not Downloaded Documents.\n",
    "select Distinct Login_Logout_Log.Userid,tbl_clyzoemployeemaster.Employee_FirstName,tbl_clyzoemployeemaster.Employee_LastName,tbl_clyzoemployeemaster.Company_Name,DomainMaster_KAE.KAE_Account from Login_Logout_Log\n",
    "left Join vwCOAMSDSTDSDocsDownload on Login_Logout_Log.Userid = vwCOAMSDSTDSDocsDownload.User_ID\n",
    "Join tbl_clyzoemployeemaster on tbl_clyzoemployeemaster.ID = Login_Logout_Log.Userid\n",
    "Join DomainEmployeeMap on tbl_clyzoemployeemaster.ID = DomainEmployeeMap.ClyzoEmployeeMaster\n",
    "Join DomainMaster on DomainEmployeeMap.DomainID = DomainMaster.Id\n",
    "Join DomainMaster_KAE on DomainMaster.KAEID = DomainMaster_KAE.KAE_ID\n",
    "where vwCOAMSDSTDSDocsDownload.User_ID IS NULL and Login_Logout_Log.LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and tbl_clyzoemployeemaster.Company_Name not in ('CLYZO_Testing','Vikram Testing','CLYZO','Swaransoft Support Solutions','Impulse Digital','IT infotech pvt ltd','xyz','sadf csds cvds cd cds','Test','profcyma','Encube')\n",
    "order by tbl_clyzoemployeemaster.Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Downloaded Documents but Did Not Submit Quotations.\n",
    "SELECT \n",
    "Distinct \n",
    "    vwCOAMSDSTDSDocsDownload.User_ID,\n",
    "\tvwCOAMSDSTDSDocsDownload.DownloadDateTime,\n",
    "    vwCOAMSDSTDSDocsDownload.USRNAME,\n",
    "    vwCOAMSDSTDSDocsDownload.Company_Name,\n",
    "    vwCOAMSDSTDSDocsDownload.Email,\n",
    "    vwCOAMSDSTDSDocsDownload.Product_Code,\n",
    "    vwCOAMSDSTDSDocsDownload.Supplier_Product_Name,\n",
    "    vwCOAMSDSTDSDocsDownload.Document_Name, \n",
    "    vwCOAMSDSTDSDocsDownload.KAE_Account\n",
    "FROM vwCOAMSDSTDSDocsDownload\n",
    "LEFT JOIN bivwQuotation_Report\n",
    "    ON vwCOAMSDSTDSDocsDownload.Email = bivwQuotation_Report.Email\n",
    "    AND vwCOAMSDSTDSDocsDownload.Product_Code = bivwQuotation_Report.Product_Code\n",
    "WHERE bivwQuotation_Report.Product_Code IS NULL\n",
    "AND vwCOAMSDSTDSDocsDownload.Company_Name NOT IN ('Jodas Expoim Pvt Ltd', 'Clyzo', 'Pharmonix Biologicals Private Limited', 'Planet Science', 'clyzo')\n",
    "AND vwCOAMSDSTDSDocsDownload.DownloadDateTime BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "ORDER BY vwCOAMSDSTDSDocsDownload.Company_Name;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Sent Requests but Did Not Submit Quotations.\n",
    "select bivwRequest_Report.ClyzoRequestno,bivwRequest_Report.RequestType,bivwRequest_Report.ProductName,bivwRequest_Report.ProductCode, bivwRequest_Report.CompanyName,bivwRequest_Report.user_name,bivwRequest_Report.KAE from bivwRequest_Report \n",
    "Left Join bivwQuotation_Report\n",
    "on bivwRequest_Report.ProductCode = bivwQuotation_Report.Product_Code\n",
    "where bivwQuotation_Report.Product_Code Is Null\n",
    "and bivwRequest_Report.CompanyName not in('IT infotech pvt ltd','Plane Science','Swaransoft Support Solutions','Jodas Expoim Pvt Ltd','Clyzo','Pharmonix Biologicals Private Limited','Planet Science','clyzo') and bivwRequest_Report.DateofRequest BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "order by bivwRequest_Report.ProductCode\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Generated Quotations but Did Not Convert Them into Orders\n",
    "SELECT \n",
    "    Company_Name, \n",
    "    COUNT(DISTINCT CASE WHEN QuotationStatus = 'Quotation Generated' THEN QutationNo END) AS generated_count,  \n",
    "    COUNT(DISTINCT CASE WHEN QuotationStatus = 'Converted to Order' THEN QutationNo END) AS converted_count,  \n",
    "    YEAR(Added_Date) AS year,\n",
    "    Assign_ToName AS Key_Account  \n",
    "FROM \n",
    "    bivwQuotation_Report\n",
    "WHERE \n",
    "    Company_Name NOT IN ('The Impulse Digital','Impulse Digital','Inventia Healthcare Limited','CLYZO','encube ethicals pvrt ltd','Pharmonix','Pharmonix Biologicals Private Limited','Planet Science','Planet Science Private Limited','Swaransoft Support Solutions') and Assign_ToName not in ('RosySawant')\n",
    "GROUP BY \n",
    "    company_name, \n",
    "    YEAR(Added_Date),\n",
    "    Assign_ToName  \n",
    "HAVING \n",
    "    COUNT(DISTINCT CASE WHEN QuotationStatus = 'Quotation Generated' THEN QutationNo END) > 1  \n",
    "    AND COUNT(DISTINCT CASE WHEN QuotationStatus = 'Quotation Generated' THEN QutationNo END) > COUNT(DISTINCT CASE WHEN QuotationStatus = 'Converted to Order' THEN QutationNo END) \n",
    "ORDER BY \n",
    "    year;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Send Multiple Requests but Have Not Generated Quotations or Orders.\n",
    "SELECT \n",
    "    bivwRequest_Report.CompanyName, \n",
    "    COUNT(DISTINCT bivwRequest_Report.ClyzoRequestno) AS request_count,  -- Count of Requests Made\n",
    "    COUNT(DISTINCT CASE WHEN bivwQuotation_Report.QuotationStatus = 'Quotation Generated' THEN bivwQuotation_Report.QutationNo END) AS quotation_count, \n",
    "    COUNT(DISTINCT CASE WHEN bivwQuotation_Report.QuotationStatus = 'Converted to Order' THEN bivwQuotation_Report.QutationNo END) AS order_count, \n",
    "\tYEAR(bivwRequest_Report.DateofRequest) AS year,\n",
    "    bivwRequest_Report.KAE AS Key_Account\n",
    "FROM \n",
    "    bivwRequest_Report  \n",
    "LEFT JOIN \n",
    "    bivwQuotation_Report \n",
    "ON \n",
    "    bivwRequest_Report.CompanyName = bivwQuotation_Report.Company_Name  \n",
    "WHERE \n",
    "    bivwRequest_Report.CompanyName NOT IN ('Swaransoft Support Solutions Pvt. Ltd.','IT infotech pvt ltd','RAM Testing','Swaransoft','webinfo','Swaransoft Support Solutions Pvt Ltd.','Swaran Soft Support solution Pvt Ltd','SwaranSoft.com pvt','The Impulse Digital','Impulse Digital','Inventia Healthcare Limited','CLYZO','encube ethicals pvrt ltd','Pharmonix','Pharmonix Biologicals Private Limited','Planet Science','Planet Science Private Limited','Swaransoft Support Solutions')\n",
    "GROUP BY \n",
    "    bivwRequest_Report.CompanyName,\n",
    "    YEAR(bivwRequest_Report.DateofRequest),\n",
    "    bivwRequest_Report.KAE\n",
    "HAVING \n",
    "    COUNT(DISTINCT bivwRequest_Report.ClyzoRequestno) > 3 \n",
    "    AND COUNT(DISTINCT CASE WHEN bivwQuotation_Report.QuotationStatus = 'Quotation Generated' THEN bivwQuotation_Report.QutationNo END) = 0  \n",
    "    AND COUNT(DISTINCT CASE WHEN bivwQuotation_Report.QuotationStatus = 'Converted to Order' THEN bivwQuotation_Report.QutationNo END) = 0  \n",
    "ORDER BY \n",
    "    request_count DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Added Products to Their Cart but Did Not Place Quotations for Those Products.\n",
    "select tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,tbl_ClyzoEmployeeMaster.Email,tbl_ClyzoEmployeeMaster.Company_Name,Cart.ClyzoMasterProduct_ID,Cart.SupplierMasterProduct_ID,ClyzoProductMaster.Product_Code,ClyzoProductMaster.Product_Name,DomainMaster_KAE.KAE_Account,Cart.Added_Date from Cart\n",
    "Join tbl_ClyzoEmployeeMaster\n",
    "on Cart.EmployeeMaster_Id = tbl_ClyzoEmployeeMaster.ID\n",
    "Join ClyzoProductMaster\n",
    "on Cart.ClyzoMasterProduct_ID = ClyzoProductMaster.ID\n",
    "Join DomainEmployeeMap\n",
    "on tbl_ClyzoEmployeeMaster.ID = DomainEmployeeMap.ClyzoEmployeeMaster\n",
    "join DomainMaster\n",
    "on DomainEmployeeMap.DomainID = DomainMaster.Id\n",
    "Join DomainMaster_KAE\n",
    "on DomainMaster.KAEID = DomainMaster_KAE.KAE_ID\n",
    "where tbl_ClyzoEmployeeMaster.Company_Name not in ('The Impulse Digital','West Info Pvt.Ltd,''encube ethicals pvrt ltd','xyz','JT PHARMA PVT LTD','sadf csds cvds cd cds','JAYDFSD Pharmscd nvfdjn','Pharmaaaa123wsds','asfsdf wefesf wef ','The Impulse Digital','encube ethicals pvrt ltd','asfsdf wefesf wef ','The Impulse Digital','JT PHARMA PVT LTD','PWT Pvt.Ltd','Sabiha Research & Development','Swaransoft Support Solutions','Pharmonix Biologicals Private Limited','Planet Science Private Limited','CLYZO','Inventia Healthcare Limited','Pharmonix Biologicals Pvt. Ltd.','Pharmonix','Orange Pharma','US KS S BS','Plane Science','Planet Science','IT infotech pvt ltd','Impulse Digital','ELCON DRUGS AND FORMULATIONS LTD') and Email not in ('aparna@planetscience.in','keonpharma@gmail.com','elconamit@gmail.com')\n",
    "and cart.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "order by Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users with Frequent Login and Logout Activities Who Have Not Created Any Quotations.\n",
    "SELECT \n",
    "    tbl_ClyzoEmployeeMaster.Company_Name,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_FirstName,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_LastName,\n",
    "    tbl_ClyzoEmployeeMaster.Email,\n",
    "    Login_Logout_Log.UserId,\n",
    "    COUNT(Login_Logout_Log.LoginDate) AS Login_Count,\n",
    "    COALESCE(COUNT(bivwQuotation_Report.Added_Date), 0) AS Quotation_Count\n",
    "FROM \n",
    "    Login_Logout_Log\n",
    "JOIN tbl_ClyzoEmployeeMaster\n",
    "    ON Login_Logout_Log.UserId = tbl_ClyzoEmployeeMaster.ID\n",
    "LEFT JOIN bivwQuotation_Report\n",
    "    ON tbl_ClyzoEmployeeMaster.Email = bivwQuotation_Report.Email \n",
    "    AND bivwQuotation_Report.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "WHERE \n",
    "    tbl_ClyzoEmployeeMaster.Company_Name NOT IN (\n",
    "        'CLYZO', '3245465erdfgfcb fchgvn', 'Impulse Digital', 'Inventia Healthcare Limited',\n",
    "        'IT infotech pvt ltd', 'JAYDFSD Pharmscd nvfdjn', 'Orange Pharma', 'Pharmaaaa123wsds',\n",
    "        'Pharmonix', 'Pharmonix Biologicals Private Limited', 'Pharmonix Biologicals Pvt. Ltd.',\n",
    "        'Plane Science', 'Planet Science', 'Planet Science Private Limited', 'PWT Pvt.Ltd',\n",
    "        'Sabiha Research & Development', 'SPIT', 'Swaransoft Support Solutions', 'The Impulse Digital', 'xyz','Jodas Expoim Pvt Ltd','sadf csds cvds cd cds','CLYZO_Testing','Vikram Testing','Test'\n",
    "    ) \n",
    "    AND Login_Logout_Log.LoginDate BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "GROUP BY \n",
    "    tbl_ClyzoEmployeeMaster.Company_Name,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_FirstName,\n",
    "    tbl_ClyzoEmployeeMaster.Employee_LastName,\n",
    "    tbl_ClyzoEmployeeMaster.Email,\n",
    "    Login_Logout_Log.UserId\n",
    "HAVING \n",
    "    COUNT(bivwQuotation_Report.Added_Date) = 0 \n",
    "    OR COUNT(bivwQuotation_Report.Added_Date) < COUNT(Login_Logout_Log.LoginDate)\n",
    "ORDER BY \n",
    "    Login_Count DESC;\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "---query for user who create high cart values but not created quotations.\n",
    "select  Cart.EmployeeMaster_Id,tbl_ClyzoEmployeeMaster.Company_Name,tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,Cart.Amount,Cart.SupplierMasterProduct_ID,ClyzoProductMaster.Product_Code,ClyzoProductMaster.Product_Name,DomainMaster_KAE.KAE_Account from Cart \n",
    "join tbl_ClyzoEmployeeMaster\n",
    "on Cart.EmployeeMaster_Id = tbl_ClyzoEmployeeMaster.ID\n",
    "Join ClyzoProductMaster\n",
    "on Cart.ClyzoMasterProduct_ID = ClyzoProductMaster.ID\n",
    "Join DomainEmployeeMap\n",
    "on tbl_ClyzoEmployeeMaster.ID = DomainEmployeeMap.ClyzoEmployeeMaster\n",
    "join DomainMaster\n",
    "on DomainEmployeeMap.DomainID = DomainMaster.Id\n",
    "Join DomainMaster_KAE\n",
    "on DomainMaster.KAEID = DomainMaster_KAE.KAE_ID\n",
    "where Cart.IsCart = 1 and Cart.Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59' and tbl_ClyzoEmployeeMaster.Company_Name not in ('CLYZO', '3245465erdfgfcb fchgvn', 'Impulse Digital', 'Inventia Healthcare Limited',\n",
    "        'IT infotech pvt ltd', 'JAYDFSD Pharmscd nvfdjn', 'Orange Pharma', 'Pharmaaaa123wsds',\n",
    "        'Pharmonix', 'Pharmonix Biologicals Private Limited', 'Pharmonix Biologicals Pvt. Ltd.',\n",
    "        'Plane Science', 'Planet Science', 'Planet Science Private Limited', 'PWT Pvt.Ltd',\n",
    "        'Sabiha Research & Development', 'SPIT', 'Swaransoft Support Solutions', 'The Impulse Digital', 'xyz','Jodas Expoim Pvt Ltd','sadf csds cvds cd cds','CLYZO_Testing','Vikram Testing','Test','West Info Pvt.Ltd')\n",
    "\t\tAND Cart.Amount > 100000\n",
    "order by Cart.Amount Desc\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Created Numerous Quotations but Converted Only a Few into Orders.\n",
    "SELECT \n",
    "    bivwQuotation_Report.Company_Name,\n",
    "    bivwQuotation_Report.Email,\n",
    "    COUNT(CASE WHEN bivwQuotation_Report.QuotationStatus = 'Quotation Generated' THEN 1 END) AS Quotation_Generated_Count,\n",
    "    COUNT(CASE WHEN bivwQuotation_Report.QuotationStatus = 'Converted to Order' THEN 1 END) AS Quotation_Converted_Count,\n",
    "    COUNT(CASE WHEN bivwQuotation_Report.QuotationStatus IN ('Quotation Generated', 'Converted to Order') THEN 1 END) AS Total_Quotation_Count\n",
    "FROM \n",
    "    bivwQuotation_Report\n",
    "WHERE \n",
    "    bivwQuotation_Report.Company_Name NOT IN (\n",
    "        'CLYZO', '3245465erdfgfcb fchgvn', 'Impulse Digital', 'Inventia Healthcare Limited','KEON TECHNOLOGIES PVT LTD',\n",
    "        'IT infotech pvt ltd', 'JAYDFSD Pharmscd nvfdjn', 'Orange Pharma', 'Pharmaaaa123wsds','Luxmatra Innovations Pvt Ltd',\n",
    "        'Pharmonix', 'Pharmonix Biologicals Private Limited', 'Pharmonix Biologicals Pvt. Ltd.',\n",
    "        'Plane Science', 'Planet Science', 'Planet Science Private Limited', 'PWT Pvt.Ltd','ELCON DRUGS AND FORMULATIONS LTD',\n",
    "        'Sabiha Research & Development', 'SPIT', 'Swaransoft Support Solutions', 'The Impulse Digital', 'xyz',\n",
    "        'Jodas Expoim Pvt Ltd', 'sadf csds cvds cd cds', 'CLYZO_Testing', 'Vikram Testing', 'Test', 'West Info Pvt.Ltd'\n",
    "    )\n",
    "    AND Added_Date BETWEEN '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "GROUP BY \n",
    "    bivwQuotation_Report.Company_Name,\n",
    "    bivwQuotation_Report.Email\n",
    "HAVING \n",
    "      \n",
    "    COUNT(CASE WHEN bivwQuotation_Report.QuotationStatus = 'Converted to Order' THEN 1 END) < \n",
    "    COUNT(CASE WHEN bivwQuotation_Report.QuotationStatus = 'Quotation Generated' THEN 1 END)\n",
    "ORDER BY \n",
    "    Total_Quotation_Count DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Frequently Download Documents but Have Not Submitted Any Quotations.\n",
    "SELECT \n",
    "    d.Email, \n",
    "    d.Document_Name, \n",
    "    COUNT(*) AS download_count,\n",
    "    d.Company_Name,\n",
    "    d.USRNAME,\n",
    "    d.Supplier_Product_Name\n",
    "FROM \n",
    "    vwCOAMSDSTDSDocsDownload d\n",
    "LEFT JOIN \n",
    "    bivwQuotation_Report q\n",
    "    ON d.Email = q.Email\n",
    "WHERE \n",
    "    d.Company_Name NOT IN (\n",
    "        'Pharmonix Biologicals Pvt. Ltd.', 'clyzo', 'CLYZO', 'Planet Science', \n",
    "        'Plane Science', 'Pharmonix Biologicals Private Limited', 'Pharmonix', \n",
    "        'Planet Science Private Limited', 'Inventia Healthcare Limited'\n",
    "    )\n",
    "    AND q.QutationNo IS NULL  -- Ensures that the user has not provided any quotations\n",
    "GROUP BY \n",
    " d.Document_Name, d.Company_Name, d.Email, d.USRNAME, d.Supplier_Product_Name\n",
    "HAVING \n",
    "    COUNT(*) > 2\n",
    "ORDER BY \n",
    "    download_count DESC;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Frequently Send Requests.\n",
    "select Count (ClyzoRequestno) as Request_Count,RequestType,CompanyName,user_name from  bivwRequest_Report\n",
    "Where CompanyName not in ('encube ethicals pvrt ltd','swaransoft.com','SwaranSoft.com pvt23','234refdsvfgd revfdv','The Impulse Digital','IT infotech pvt ltd','RAM Testing','Swaransoft Support Solutions Pvt. Ltd.','Swaransoft Support Solutions','Swaransoft Support Solutions','Swaran Soft Support solution Pvt Ltd','Swaransoft','webinfo','Swaransoft Support Solutions Pvt Ltd.','SwaranSoft.com pvt','Pharmonix Biologicals Pvt. Ltd.','clyzo','CLYZO','Planet Science','Plane Science','Pharmonix Biologicals Private Limited','Pharmonix','Planet Science Private Limited','Inventia Healthcare Limited')\n",
    "Group by RequestType,CompanyName,user_name\n",
    "order by Request_Count Desc\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Visited the Product Page but Did Not Create Any Quotations.\n",
    "select bivwpropagevisitreport.UserEmail,bivwpropagevisitreport.CompanyName,bivwpropagevisitreport.ProductName,Count(*) as visit_count from bivwpropagevisitreport\n",
    "Left Join bivwQuotation_Report\n",
    "on bivwpropagevisitreport.UserEmail = bivwQuotation_Report.Email\n",
    "where bivwpropagevisitreport.CompanyName not in ('','Swaransoft','S.waransoft','Non-Domain','CLYZO') \n",
    "Group by bivwpropagevisitreport.UserEmail,bivwpropagevisitreport.CompanyName,bivwpropagevisitreport.ProductName\n",
    "Having Count (*) >5\n",
    "order by visit_count Desc\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Downloaded the Most Certificates of Analysis (COA).\n",
    "select User_ID,USRNAME,Email,Company_Name,Document_Name,COUNT(*) AS download_count from vwCOAMSDSTDSDocsDownload\n",
    "where Document_Name in ('COA') and Company_Name not in ('Plane Science','Swaransoft Support Solutions','Planet Science Private Limited','Planet Science','Pharmonix Biologicals Pvt. Ltd.','Pharmonix Biologicals Private Limited','CLYZO','clyzo','Clyzo')\n",
    "group By User_ID,USRNAME,Email,Document_Name,Company_Name\n",
    "order by download_count DESC\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Downloaded the Most Material Safety Data Sheets (MSDS).\n",
    "select User_ID,USRNAME,Email,Company_Name,Document_Name,COUNT(*) AS download_count from vwCOAMSDSTDSDocsDownload\n",
    "where Document_Name in ('MSDS') and Company_Name not in ('Plane Science','Swaransoft Support Solutions','Planet Science Private Limited','Planet Science','Pharmonix Biologicals Pvt. Ltd.','Pharmonix Biologicals Private Limited','CLYZO','clyzo','Clyzo')\n",
    "group By User_ID,USRNAME,Email,Document_Name,Company_Name\n",
    "order by download_count DESC\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Downloaded the Most Technical Data Sheets (TDS).\n",
    "select User_ID,USRNAME,Email,Company_Name,Document_Name,COUNT(*) AS download_count from vwCOAMSDSTDSDocsDownload\n",
    "where Document_Name in ('TDS') and Company_Name not in ('Plane Science','Swaransoft Support Solutions','Planet Science Private Limited','Planet Science','Pharmonix Biologicals Pvt. Ltd.','Pharmonix Biologicals Private Limited','CLYZO','clyzo','Clyzo')\n",
    "group By User_ID,USRNAME,Email,Document_Name,Company_Name\n",
    "order by download_count DESC\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Identify Users Who Frequently Search for Products.\n",
    "select ProductName ,COUNT(*) AS search_count from bivwpropagevisitreport\n",
    "where ProductName not in ('')\n",
    "group by ProductName\n",
    "order by search_count Desc\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Calculate Month-wise and Year-wise Total Amounts.\n",
    "SELECT\n",
    "    YEAR(Added_Date) AS Year,\n",
    "    DATENAME(MONTH, Added_Date) AS Month,\n",
    "    ROUND(SUM(Final_Amount), 2) AS Total_Final_Amount\n",
    "FROM\n",
    "    bivwQuotation_Report\n",
    "WHERE\n",
    "    QuotationStatus = 'Converted to Order'\n",
    "    AND Company_Name NOT IN ('NULL', 'CLYZO', 'Impulse Digital', 'Pharmonix', 'Pharmonix Biologicals Private Limited', 'Plane Science', 'Planet Science', 'Planet Science Private Limited', 'Swaransoft Support Solutions', 'The Impulse Digital', 'West Info Pvt.Ltd')\n",
    "GROUP BY\n",
    "    YEAR(Added_Date),\n",
    "    DATENAME(MONTH, Added_Date),\n",
    "    MONTH(Added_Date)\n",
    "ORDER BY\n",
    "    Year,\n",
    "    MONTH(Added_Date);\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Calculate the Percentage Change Between Two Months.\n",
    "WITH MonthlyTotals AS (\n",
    "    SELECT\n",
    "        YEAR(Added_Date) AS Year,\n",
    "        DATENAME(MONTH, Added_Date) AS Month_Name,\n",
    "        MONTH(Added_Date) AS Month,\n",
    "        ROUND(SUM(Final_Amount), 2) AS Total_Final_Amount\n",
    "    FROM\n",
    "        bivwQuotation_Report\n",
    "    WHERE\n",
    "        QuotationStatus = 'Converted to Order'\n",
    "        AND Company_Name NOT IN ('NULL', 'CLYZO', 'Impulse Digital', 'Pharmonix', 'Pharmonix Biologicals Private Limited', 'Plane Science', 'Planet Science', 'Planet Science Private Limited', 'Swaransoft Support Solutions', 'The Impulse Digital', 'West Info Pvt.Ltd')\n",
    "    GROUP BY\n",
    "        YEAR(Added_Date),\n",
    "        DATENAME(MONTH, Added_Date),\n",
    "        MONTH(Added_Date)\n",
    ")\n",
    "\n",
    "SELECT\n",
    "    Year,\n",
    "    Month_Name,\n",
    "    Total_Final_Amount,\n",
    "    LAG(Total_Final_Amount) OVER (ORDER BY Year, Month) AS Previous_Month_Amount,\n",
    "    CASE\n",
    "        WHEN LAG(Total_Final_Amount) OVER (ORDER BY Year, Month) IS NULL OR LAG(Total_Final_Amount) OVER (ORDER BY Year, Month) = 0 THEN NULL\n",
    "        ELSE ROUND(((Total_Final_Amount - LAG(Total_Final_Amount) OVER (ORDER BY Year, Month)) * 100.0) / LAG(Total_Final_Amount) OVER (ORDER BY Year, Month), 2)\n",
    "    END AS Percentage_Change\n",
    "FROM\n",
    "    MonthlyTotals\n",
    "ORDER BY\n",
    "    Year,\n",
    "    Month;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Domain Companies Registered with Business.\n",
    "WITH CTE AS (\n",
    "    SELECT \n",
    "        DomainEmployeeMap.DomainID,\n",
    "        DomainMaster.DomainUrl,\n",
    "        tbl_ClyzoEmployeeMaster.Company_Name,\n",
    "\t\tDomainMaster.DomainStatus,\n",
    "\t\tDomainEmployeeMap.Added_Date,\n",
    "        ROW_NUMBER() OVER (PARTITION BY DomainEmployeeMap.DomainID ORDER BY DomainEmployeeMap.DomainID) AS rn\n",
    "    FROM \n",
    "        DomainMaster\n",
    "    JOIN \n",
    "        DomainEmployeeMap ON DomainMaster.Id = DomainEmployeeMap.DomainID\n",
    "    JOIN \n",
    "        tbl_ClyzoEmployeeMaster ON DomainEmployeeMap.ClyzoEmployeeMaster = tbl_ClyzoEmployeeMaster.ID\n",
    "    WHERE \n",
    "        DomainEmployeeMap.DomainID NOT IN (1)\n",
    ")\n",
    "SELECT \n",
    "    DomainID,\n",
    "    DomainUrl,\n",
    "    Company_Name,\n",
    "\tDomainStatus,\n",
    "\tAdded_Date\n",
    "FROM \n",
    "    CTE\n",
    "WHERE \n",
    "    rn = 1 and Company_Name not in ('NULL','SPIT','Clyzo','Swaransoft','PWT Pvt.Ltd','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','asfsdf wefesf wef','RAJA RAM PHarma','Pharmaaaa123wsds','Pharmabroi')\n",
    "ORDER BY \n",
    "    DomainID;\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Non Domain Companies Registered with Business.\n",
    "select ID,Employee_FirstName,Employee_LastName,Email,URLdata,Company_Name,Status,Country_Name from vwGetNondomainuser \n",
    "where Company_Name Not in ('Null','Pharmonix','Pharmonix Pvt Ltd','US KS S BS','Pharmonix Biological','Test','Pharmonix biologicals Pvt Ltd','Orange Pharma','Impulse Digital','IT infotech pvt ltd','NA','Pharma Private Limited','JT PHARMA PVT LTD','xyz','Swaransoft','WWW Pvt.Ltd','JAYDFSD Pharmscd nvfdjn','Pharmaaaa123wsds','sadf csds cvds cd cds','3245465erdfgfcb fchgvn','test','Test','SAVIT INTERACTIVE SERVICES PRIVATE LIMITED','Clyzo','The Impulse Digital','ABC','Fresher')\n",
    "order by Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve the List of Active Users.\n",
    "select ID,Employee_FirstName,Employee_LastName,DomainUrl,Email,Mobile_No,Company_Name,Added_Date,Status from vwGetActiveUser \n",
    "where Company_Name not in ('RAJA RAM PHarma','xyz','WWW Pvt.Ltd','West Info Pvt.Ltd','Pharmonix Pvt Ltd','Pharmonix Biologicals Pvt. Ltd.','Pharmonix Biological','Pharmabroi','Orange Pharma','feqwbg','NA','JAYDFSD Pharmscd nvfdjn','Fresher','ABC','NULL','234refdsvfgd revfdv ','3245465erdfgfcb fchgvn','asfsdf wefesf wef','Clyzo','clyzo','CLYZO','Impulse Digital','IT infotech pvt ltd','Pharma Private Limited','Pharmaaaa123wsds','Pharmonix','Pharmonix Biologicals Private Limited','Plane Science','Planet Science','Planet Science Private Limited','PWT Pvt.Ltd','RAM Testing','sadf csds cvds cd cds','SAVIT INTERACTIVE SERVICES PRIVATE LIMITED','SPIT','Swaransoft','Swaransoft Support Solutions','Test','The Impulse Digital','US KS S BS''NULL','234refdsvfgd revfdv ','asfsdf wefesf wef','Clyzo','clyzo','CLYZO','Impulse Digital','IT infotech pvt ltd','Pharma Private Limited','Pharmaaaa123wsds','Pharmonix','Pharmonix Biologicals Private Limited','Plane Science','Planet Science','Planet Science Private Limited','PWT Pvt.Ltd','RAM Testing','sadf csds cvds cd cds','SAVIT INTERACTIVE SERVICES PRIVATE LIMITED','SPIT','Swaransoft','Swaransoft Support Solutions','Test','The Impulse Digital','US KS S BS')\n",
    "order by Company_Name\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve the Complete List of Users.\n",
    "select tbl_ClyzoEmployeeMaster.ID, tbl_ClyzoEmployeeMaster.Employee_FirstName,tbl_ClyzoEmployeeMaster.Employee_LastName,tbl_ClyzoEmployeeMaster.Email,tbl_ClyzoEmployeeMaster.Mobile_No,tbl_ClyzoEmployeeMaster.Added_Date,tbl_ClyzoEmployeeMaster.Company_Name,tbl_ClyzoEmployeeMaster.Designation,tbl_ClyzoEmployeeMaster.Department_Name,tbl_ClyzoEmployeeLoginMaster.Status from tbl_ClyzoEmployeeLoginMaster\n",
    "Join tbl_ClyzoEmployeeMaster\n",
    "on tbl_ClyzoEmployeeLoginMaster.Employee_ID = tbl_ClyzoEmployeeMaster.ID \n",
    "where Company_Name not in ('Pharmonix biologicals Pvt Ltd','RAJA RAM PHarma','xyz','WWW Pvt.Ltd','West Info Pvt.Ltd','Pharmonix Pvt Ltd','Pharmonix Biologicals Pvt. Ltd.','Pharmonix Biological','Pharmabroi','Orange Pharma','feqwbg','NA','JAYDFSD Pharmscd nvfdjn','Fresher','ABC','NULL','234refdsvfgd revfdv ','3245465erdfgfcb fchgvn','asfsdf wefesf wef','Clyzo','clyzo','CLYZO','Impulse Digital','IT infotech pvt ltd','Pharma Private Limited','Pharmaaaa123wsds','Pharmonix','Pharmonix Biologicals Private Limited','Plane Science','Planet Science','Planet Science Private Limited','PWT Pvt.Ltd','RAM Testing','sadf csds cvds cd cds','SAVIT INTERACTIVE SERVICES PRIVATE LIMITED','SPIT','Swaransoft','Swaransoft Support Solutions','Test','The Impulse Digital','US KS S BS''NULL','234refdsvfgd revfdv ','asfsdf wefesf wef','Clyzo','clyzo','CLYZO','Impulse Digital','IT infotech pvt ltd','Pharma Private Limited','Pharmaaaa123wsds','Pharmonix','Pharmonix Biologicals Private Limited','Plane Science','Planet Science','Planet Science Private Limited','PWT Pvt.Ltd','RAM Testing','sadf csds cvds cd cds','SAVIT INTERACTIVE SERVICES PRIVATE LIMITED','SPIT','Swaransoft','Swaransoft Support Solutions','Test','The Impulse Digital','US KS S BS','RAJA RAM PHarma','xyz','WWW Pvt.Ltd','West Info Pvt.Ltd','Pharmonix Pvt Ltd','Pharmonix Biologicals Pvt. Ltd.','Pharmonix Biological','Pharmabroi','Orange Pharma','feqwbg','NA','JAYDFSD Pharmscd nvfdjn','Fresher','ABC','NULL','234refdsvfgd revfdv ','3245465erdfgfcb fchgvn','asfsdf wefesf wef','Clyzo','clyzo','CLYZO','Impulse Digital','IT infotech pvt ltd','Pharma Private Limited','Pharmaaaa123wsds','Pharmonix','Pharmonix Biologicals Private Limited','Plane Science','Planet Science','Planet Science Private Limited','PWT Pvt.Ltd','RAM Testing','sadf csds cvds cd cds','SAVIT INTERACTIVE SERVICES PRIVATE LIMITED','SPIT','Swaransoft','Swaransoft Support Solutions','Test','The Impulse Digital','US KS S BS')\n",
    "order by Status\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Total Quotation Count, Total Quotation Amount, Quotation-to-Order Conversion Count, and Quotation-to-Order Conversion Amount.\n",
    "SELECT \n",
    "    COUNT(QutationNo) AS Total_Quotation_Count,\n",
    "    SUM(Price_INR) AS Total_Quotation_Amount,\n",
    "    SUM(CASE WHEN QuotationStatus = 'Converted to order' THEN 1 ELSE 0 END) AS Converted_To_Order_Count,\n",
    "    SUM(CASE WHEN QuotationStatus = 'Converted to order' THEN Price_INR ELSE 0 END) AS Converted_To_Order_Amount,\n",
    "    SUM(CASE WHEN QuotationStatus = 'Quotation generated' THEN 1 ELSE 0 END) AS Quotation_Generated_Count,\n",
    "    SUM(CASE WHEN QuotationStatus = 'Quotation generated' THEN Price_INR ELSE 0 END) AS Quotation_Generated_Amount\n",
    "FROM \n",
    "    dbo.tbl_Quotation\n",
    "where Added_Date between '2023-01-01 00:00:00' and  '2024-12-01 11:59:59'\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve the Total Supplier Count.\n",
    "SELECT COUNT(DISTINCT ID) AS Supplier_Count FROM dbo.SupplierMaster\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Search Type Counts in Descending Order.\n",
    "SELECT TOP 5 SearchType, SearchType_Count FROM \n",
    "(SELECT SearchType, COUNT(SearchType) AS SearchType_Count FROM dbo.Tbl_SearchHistory\n",
    "GROUP BY SearchType) AS Subquery\n",
    "ORDER BY SearchType_Count DESC\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Calculate the Count of Quotation Status in Descending Order.\n",
    "SELECT QuotationStatus, COUNT(QuotationStatus) AS Count\n",
    "FROM \n",
    "(SELECT QutationNo,Price_INR, \n",
    "        REPLACE(QuotationStatus, 'Assigned to KAE', 'Quotation is in processing') AS QuotationStatus\n",
    "FROM dbo.tbl_Quotation) AS Subquery\n",
    "GROUP BY QuotationStatus\n",
    "\n",
    "\n",
    "\n",
    "---SQL query for finding out all request activity.\n",
    "SQL Query to Retrieve All Request Activities\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve All Request Types.\n",
    "select * from RequestType\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve All Salespersons in the Organization.\n",
    "select * from DomainMaster_KAE\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Users Associated with Businesses.\n",
    "select * from tbl_ClyzoEmployeeMaster\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve User Search History Records.\n",
    "select * from Tbl_SearchHistory\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve User Activity Records.\n",
    "select * from UserActivityPage\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Quotation Analysis of customer.\n",
    "select * from bivwQuotation_Report\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Request Analysis of customer.\n",
    "select * from bivwRequest_Report\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Product Page Visit Report.\n",
    "select * from bivwpropagevisitreport\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Supplier Data.\n",
    "select * from Supplierproductmaster\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Login activity of user.\n",
    "Select * from Login_Logout_Log\n",
    "\n",
    "\n",
    "\n",
    "---SQL Query to Retrieve Master product Data.\n",
    "Select * from ClyzoProductMaster\n",
    "\n",
    "\n",
    "\n",
    "---SQl Query to Retrieve users sign up activity.\n",
    "Select * from tbl_ClyzoEmployeeLoginMaster\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n",
    "\n"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
